\documentclass[12pt]{report}

\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}

\usepackage[polish]{babel}
\usepackage[cp1250]{inputenc}
\usepackage{t1enc}
\usepackage{graphics}
\usepackage{graphicx}
\usepackage{color}

\textwidth=15cm \textheight=24cm \oddsidemargin=0.5cm
\topmargin=-0.5cm
\textwidth=15cm \textheight=24cm \oddsidemargin=0.5cm
\topmargin=-2cm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\DeclareMathOperator{\R}{\mathbb{R}}
\def\\{\hfill\break}
\def\1{{\mathbf 1}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\centerline{\large Analiza 2}
\bigskip
\centerline{\large Analiza zdarzeñ ekstremalnych}
\bigskip

\centerline{ Antonina Brzeska 246824}
\bigskip

\\{\bf 1. Krótki opis wybranych danych. } Zestaw danych opisuje zanotowane wysokoœci fal na wybrze¿u Australijskim w  miejscowoœci Mooloolaba. Wybrane pomiary zawieraj¹ 29108 rekordów, z czego mierzono je w okresie 20 miesiêcy pocz¹wszy od stycznia 2017 roku. W ka¿dym miesi¹cu pobrano podobn¹ iloœæ danych (47 rekordów dziennie), dlatego mo¿na za³o¿yæ, ¿e analizowane dalej bloki odpowiadaj¹ kolejnym miesi¹com.

\bigskip

\\{\bf 2. Analiza metod¹ maksimów blokowych (BMM).} Wyestymowano parametry rozk³adu GEV w oparciu o maksima z ustalonych bloków miesiêcznych:
\bigskip

$$\begin {array} {|c|c|c|c|}
\hline
      \ & \mbox{xi} & \mbox{sigma}& \mbox{mu} \\
\hline              
\mbox{Parametry rozk³adu GEV}&  -0.3372591 & 1.0874319 &  4.5626598\\
\hline
\end{array}$$
\bigskip

$xi < 0$, wiêc dystrybuanta F zbiegaj¹ca do rozk³adu GEV nale¿y do maksymalnej dziedziny przyci¹gania Weibulla.

\bigskip
\bigskip

\noindent{ Przeprowadzono analizê oceniaj¹c¹ dobroæ dopasowania za pomoc¹ nastêpuj¹cych wykresów diagnostycznych:} 

\noindent 
\begin{itemize}
	\item Dobroæ dopasowania na histogramie:
\end{itemize}
\centerline{\includegraphics[width=16cm, height=10cm]{bloki-images/histogram}}
\bigskip
\bigskip
\begin{itemize}
	\item Wykres maksimów blokowych:
\end{itemize}
\centerline{\includegraphics[width=16cm, height=10cm]{bloki-images/blockMaxima}}

\bigskip
\bigskip

\begin{itemize}
	\item Wykres kwantyli dopasowanego rozk³adu:
\end{itemize}
\centerline{\includegraphics[width=16cm, height=10cm]{bloki-images/QQplotOfResiduals}}

\bigskip
\bigskip


\begin{itemize}
	\item Wykres punktowy:
\end{itemize}
\bigskip
\bigskip
\centerline{\includegraphics[width=16cm, height=10cm]{bloki-images/scatterplot}}

\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip


\centerline {\bf Wyznaczono poziomy zwrotu $x_{20}$:}

$$\begin{tabular}{|c|}
	\hline 
	{Poziomu zwrotu $x_{20}$} \\ 
	\hline 
	6.602865 \\ 
	\hline 
\end{tabular} $$
\bigskip


\begin{minipage}[c]{14cm}
Poziom zwrotu obliczony metod¹ maksimów blokowych dla 20-stu bloków, z czego ka¿dy blok zawiera œrednio 30*47 rekordów (47 spisów dziennie przez 30 dni) wynosi 6.602865. Oznacza to, ¿e œrednio raz na miesi¹c mo¿na spodziewaæ siê, ¿e wysokoœæ fal przekroczy 6,6 metra.
\end{minipage}


\begin{minipage}[c]{14cm}
%\includegraphics[width=14cm]{wykresy.png}
\end{minipage}

\newpage

\\{\bf 3. Analiza metod¹ przekroczeñ progu (POT).} Kwantyl 95\% $u=3.8$ co oznacza, ¿e 5\% mierzonych fal przekracza³o wysokoœæ 3.8 m.  Ustalono próg na tym poziomie i wyestymowano parametry rozk³adu GPD dla nadwy¿ek nad ten próg:

$$\begin {array} {|c|c|c|}
\hline
\ & \mbox{xi} & \mbox{beta} \\
\hline              
\mbox{Parametry rozk³adu GPD}&  -0.1663637 & 0.7715406 \\
\hline
\end{array}$$
\bigskip

\bigskip
\bigskip
\bigskip
\bigskip

\noindent{ Przeprowadzono analizê oceniaj¹c¹ dobroæ dopasowania za pomoc¹ nastêpuj¹cych wykresów diagnostycznych:} 
\bigskip

\noindent 
\begin{itemize}
	\item Wykres rozrzutu z zaznaczonym progiem:
\end{itemize}
	\centerline{\includegraphics[width=16cm, height=10cm]{pot-images/wykresyRozrzutuZZaznaczonymProgiem9901}}
\bigskip
\bigskip
\newpage

\begin{itemize}
	\item Wykres nadwy¿ek nad próg 99\%:
\end{itemize}
\centerline{\includegraphics[width=16cm, height=10cm]{pot-images/nadwyzkiNadProg99procent02}}
\bigskip
\bigskip

\begin{itemize}
	\item Dobroæ dopasowania na histogramie:
\end{itemize}
\centerline{\includegraphics[width=16cm, height=10cm]{pot-images/dobrocDopasowaniaHistogram04}}
\bigskip

\begin{itemize}
	\item Wykres kwantyli dopasowanego rozk³adu:
\end{itemize}
\centerline{\includegraphics[width=16cm, height=10cm]{pot-images/dobrocDopasowaniaQqplot05}}

\bigskip
\bigskip
\bigskip

\centerline {\bf Wyznaczono poziom zwrotu $x_{20}$:}


$$\begin{tabular}{|c|}
\hline 
{Poziomu zwrotu $x_{20}$} \\ 
\hline 
 6.689767  \\ 
\hline 
\end{tabular} $$
\bigskip

\begin{minipage}[c]{14cm}
	Poziom zwrotu obliczony metod¹ przekroczeñ progu wynosi 6.689767. Oznacza to, ¿e œrednio raz na miesi¹c wysokoœæ fal bêdzie mia³a tak¹ wartoœæ lub j¹ przekroczy.
\end{minipage}

\bigskip
\bigskip
\bigskip

\newpage

\\{\bf 4. Analiza metod¹ Bootstrap.} Wygenerowano 10000 prób bootrapowych. Ka¿da próba jest œredni¹, median¹ lub wartoœci¹ maksymaln¹ puli 28 danych. 

$$\begin {array} {|c|c|c|c|c|}
\hline
\ & \mbox{Kwantyl oryginalnych danych} & \mbox{Bootsrap: funkcja f()=max()}  & \mbox{f()=œrednia()} & \mbox{f()=mediana()} \\
\hline              
\mbox{$x_{20}$}&  3.8 [m] & 5.615 [m]& 2.20525 [m] & 2.322766 [m]  \\
\hline
\end{array}$$

\bigskip

{\bf Wniosek: } Przy wyznaczaniu wartoœci ekstremalnych metod¹ bootstrapow¹ wybranie œredniej lub mediany jako funkcjê konwertuj¹c¹ dane jest wyj¹tkowo nieoptymalne- wyniki s¹ gorsze ni¿ przed generacj¹ próbek. Dobrze sprawdza siê natomiast funkcja max(), której wynik przekracza kwantyl oryginalnych danych.

\bigskip
\bigskip
\bigskip

\begin{itemize}
	\item Histogram próbki bootrapowej (z funkcj¹ wyliczaj¹c¹ œrednie) z zaznaczonym kwantylem:
\end{itemize}

\centerline{\includegraphics[width=16cm, height=10cm]{images-general/histogram-bootstrap}}

\newpage
\\{\bf 5. Backtesting.} Backtesting przeprowadzono w pêtli 500 iteracji testuj¹c kolejne przedzia³y 1000 danych. Przetestowano dane metod¹ historyczn¹, bootstrapow¹ z funkcjami max i œrednich, metod¹ POT przekroczeñ progu oraz maksimów blokowych.

\bigskip

{\includegraphics[width=6cm, height=3cm]{images-general/legenda}}
\newline
\centerline{\includegraphics[width=16cm, height=10cm]{images-general/backtesting}}

\\{\bf 6. Podsumowanie.} Analizuj¹c powy¿sze wykresy oraz obliczenia mo¿na zauwa¿yæ, ¿e analiza metod¹ przekroczeñ progów  osi¹ga wiêkszy poziom zwrotu ni¿ metoda przekroczeñ progu (tabela  poni¿ej). Metoda bootstrapowa zwracaj¹ca œrednie wartoœci przedzia³ów danych w tym przypadku jest nieefektowna- uœredniaj¹c traci siê dane ektremalne. St¹d wniosek, ¿e w przypadku analizy wysokoœci fal metoda przekroczeñ progu (POT) jest najefektywniejsza.

$$\begin {array} {|c|c|c|c|}
\hline
\ & \mbox{Metoda maksimów blokowych} & \mbox{Przekroczeñ progu}& \mbox{Bootstrap f=œrednia()}  \\
\hline              
\mbox{Poziom zwrotu $x_{20}$}&  6.602865 [m] & 6.689767 [m] & 2.20525 [m]\\
\hline
\mbox{Ró¿nica} & \multicolumn{2}{c|}{8,69 [cm]} &\\
\hline
\end{array}$$

\bigskip
\bigskip
\bigskip


\noindent{\bf ród³a danych:} 

\noindent 
\begin{itemize}
	\item https://www.kaggle.com/jolasa/waves-measuring-buoys-data-mooloolaba
\end{itemize}

\end{document}
